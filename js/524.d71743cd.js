"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[524],{27673:function(e,t,n){n.a(e,(async function(e,r){try{n(85827);var a=n(66252),o=n(2262),l=n(30370),u=n(92479),i=n(86690),d=n(36079),c=n(62478),s=n(30119),f=n(83927),h=n(14323),p=e([l,u,i,d,c]);[l,u,i,d,c]=p.then?(await p)():p;const m=(0,a.Uk)(" 新增 "),v={name:"SystemPermissionRole"};t.Z=(0,a.aZ)({...v,setup(e){const t=(0,o.iH)(),[n]=(0,c.U)(),r=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return t.reduce(((t,a)=>{var o;return null!==(o=a.children)&&void 0!==o&&o.length?r(e,a.children,n):e.includes(a.value)&&t.push(a.value),t}),n)},p=async e=>{var a;const[o]=await n({modalProps:{title:(e.id?"编辑":"新增")+"角色",width:"50%",onFinish:async n=>{var r,a,u,i,d;e.id&&(n.roleId=e.id);const c=null===(r=o.value)||void 0===r||null===(a=r.compRefs)||void 0===a?void 0:a.menus,s=null===(u=o.value)||void 0===u||null===(i=u.compRefs)||void 0===i?void 0:i.depts,f={...n,menus:[...c.halfCheckedKeys,...c.checkedKeys],depts:[...s.halfCheckedKeys,...s.checkedKeys]};await(e.id?l.ul:l.fA)(f),null===(d=t.value)||void 0===d||d.refreshTable()}},formSchema:{labelWidth:100,layout:"vertical",schemas:f.y}}),[d,c]=await Promise.all([(0,u.U4)(),(0,i.Af)()]),s=(0,h.bl)(c),p=(0,h.fl)(d);if(null===(a=o.value)||void 0===a||a.updateSchema([{field:"menus",componentProps:{treeData:s}},{field:"depts",componentProps:{treeData:p}}]),e.id){var m;const t=await(0,l.Xt)({roleId:e.id}),n=t.menus.map((e=>e.menuId)),a=t.depts.map((e=>e.departmentId));null===(m=o.value)||void 0===m||m.setFieldsValue({...e,name:t.roleInfo.name,label:t.roleInfo.label,remark:t.roleInfo.remark,menus:r(n,s),depts:r(a,p)})}},v=[...s.f,{title:"操作",width:160,dataIndex:"$action",hideInSearch:!0,align:"center",fixed:"right",actions:e=>{let{record:n}=e;return[{label:"编辑",auth:{perm:"sys.role.update",effect:"disable"},onClick:()=>p(n)},{label:"删除",auth:"sys.role.delete",popConfirm:{title:"你确定要删除吗？",onConfirm:()=>(async e=>{var n;await(0,l.Rd)({roleIds:[e.id]}),null===(n=t.value)||void 0===n||n.refreshTable()})(n)}}]}}];return(e,n)=>{const r=(0,a.up)("a-button");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)((0,o.SU)(d.t),{ref_key:"dynamicTableRef",ref:t,"row-key":"id","header-title":"角色管理","data-request":(0,o.SU)(l.$s),columns:v,bordered:"",size:"small"},{toolbar:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"primary",disabled:!e.$auth("sys.role.add"),onClick:n[0]||(n[0]=e=>p({}))},{default:(0,a.w5)((()=>[m])),_:1},8,["disabled"])])),_:1},8,["data-request"])])}}}),r()}catch(e){r(e)}}))},92479:function(e,t,n){n.a(e,(async function(e,r){try{n.d(t,{U4:function(){return u},aS:function(){return i},MB:function(){return d},UJ:function(){return c},m3:function(){return s}});var a=n(22586),o=n(65900),l=e([a]);function u(){return(0,a.W)({url:o.default.list,method:"get"})}function i(e){return(0,a.W)({url:"sys/dept/delete",method:"post",data:e},{successMsg:"删除成功"})}function d(e){return(0,a.W)({url:o.default.update,method:"post",data:e})}function c(e){return(0,a.W)({url:o.default.add,method:"post",data:e})}function s(e){return(0,a.W)({url:o.default.transfer,method:"post",data:e})}a=(l.then?(await l)():l)[0],r()}catch(e){r(e)}}))},86690:function(e,t,n){n.a(e,(async function(e,r){try{n.d(t,{Af:function(){return u},ZT:function(){return i},_8:function(){return d},RD:function(){return c}});var a=n(22586),o=n(43536),l=e([a]);function u(){return(0,a.W)({url:o.default.list,method:"get"})}function i(e){return(0,a.W)({url:o.default.add,method:"post",data:e},{successMsg:"创建成功"})}function d(e){return(0,a.W)({url:o.default.update,method:"post",data:e},{successMsg:"更新成功"})}function c(e){return(0,a.W)({url:o.default.delete,method:"post",data:e},{successMsg:"删除成功"})}a=(l.then?(await l)():l)[0],r()}catch(e){r(e)}}))},30370:function(e,t,n){n.a(e,(async function(e,r){try{n.d(t,{Xt:function(){return u},JV:function(){return i},$s:function(){return d},fA:function(){return c},ul:function(){return s},Rd:function(){return f}});var a=n(22586),o=n(25620),l=e([a]);function u(e){return(0,a.W)({url:o.default.info,method:"get",params:e})}function i(e){return(0,a.W)({url:o.default.list,method:"get",data:e})}function d(e){return(0,a.W)({url:o.default.page,method:"get",params:e})}function c(e){return(0,a.W)({url:o.default.add,method:"post",data:e},{successMsg:"创建角色成功"})}function s(e){return(0,a.W)({url:o.default.update,method:"post",data:e},{successMsg:"更新角色成功"})}function f(e){return(0,a.W)({url:o.default.delete,method:"post",data:e},{successMsg:"删除角色成功"})}a=(l.then?(await l)():l)[0],r()}catch(e){r(e)}}))},14323:function(e,t,n){n.d(t,{fl:function(){return r},bl:function(){return a},BQ:function(){return o}});n(85827);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.filter((e=>e.parentId===t)).map((a=>{const o=n.concat(t||[]),l=r(e,a.id,o);return Object.assign(a,{keyPath:o,title:a.name,key:a.id,value:a.id,formData:a,children:l.length?l:null})}))},a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.filter((e=>e.parentId===t)).map((r=>{const o=n.concat(t||[]),l=a(e,r.id,o);return Object.assign(r,{keyPath:o,title:r.name,key:r.id,value:r.id,formData:r,children:l.length?l:null})}))},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"children";return t.reduce(((t,a)=>{var l;return a[n]===e?a:t||(null!==(l=a[r])&&void 0!==l&&l.length?o(e,a[r],n,r):void 0)}),void 0)}},13959:function(e,t,n){n.d(t,{n:function(){return o}});var r=n(66252),a=n(2262);function o(e,t){return{initSortable:function(){(0,r.Y3)((async()=>{if(!e)return;(await n.e(474).then(n.bind(n,51474))).default.create((0,a.SU)(e),{animation:500,delay:400,delayOnTouchOnly:!0,...t})}))}}}},83927:function(e,t,n){n.d(t,{y:function(){return r}});const r=[{field:"name",component:"Input",label:"名称",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"label",component:"Input",label:"标识",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"remark",component:"InputTextArea",label:"备注"},{field:"menus",component:"Tree",label:"菜单权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"350px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}},{field:"depts",component:"Tree",label:"部门权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"350px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}}]},30119:function(e,t,n){n.d(t,{f:function(){return r}});const r=[{title:"#",dataIndex:"id",width:55,align:"center",hideInSearch:!0},{title:"名称",width:200,align:"center",dataIndex:"name"},{title:"标识",width:80,align:"center",dataIndex:"label"},{title:"备注",dataIndex:"remark",align:"center"},{title:"创建时间",dataIndex:"createdAt",align:"center",hideInSearch:!0},{title:"更新时间",align:"center",dataIndex:"updatedAt",hideInSearch:!0}]},12316:function(e,t,n){n.d(t,{C:function(){return i}});n(3462);var r=n(93162),a=n(84105);function o(e,t){for(var n,r={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},l=0;l!=e.length;++l)for(var u=0;u!=e[l].length;++u){o.s.r>l&&(o.s.r=l),o.s.c>u&&(o.s.c=u),o.e.r<l&&(o.e.r=l),o.e.c<u&&(o.e.c=u);var i={v:e[l][u]};if(null!=i.v){var d=a.P6.encode_cell({c:u,r:l});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=a.kS._table[14],i.v=(n=i.v,void 0&&(n+=1462),(Date.parse(n)-new Date(Date.UTC(1899,11,30)))/864e5)):i.t="s",r[d]=i}}return o.s.c<1e7&&(r["!ref"]=a.P6.encode_range(o)),r}function l(){if(!(this instanceof l))return new l;this.SheetNames=[],this.Sheets={}}function u(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function i(){let{multiHeader:e=[],header:t,data:n,filename:i,merges:d=[],autoWidth:c=!0,bookType:s="xlsx"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i=i||"excel-list",n=[...n],n.unshift(t);for(let t=e.length-1;t>-1;t--)n.unshift(e[t]);var f="SheetJS",h=new l,p=o(n);if(d.length>0&&(p["!merges"]||(p["!merges"]=[]),d.forEach((e=>{p["!merges"].push(a.P6.decode_range(e))}))),c){const e=n.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}))));let t=e[0];for(let n=1;n<e.length;n++)for(let r=0;r<e[n].length;r++)t[r].wch<e[n][r].wch&&(t[r].wch=e[n][r].wch);p["!cols"]=t}h.SheetNames.push(f),h.Sheets[f]=p;var m=(0,a.cW)(h,{bookType:s,bookSST:!1,type:"binary"});(0,r.saveAs)(new Blob([u(m)],{type:"application/octet-stream"}),`${i}.${s}`)}},19258:function(e,t,n){n.a(e,(async function(e,r){try{n.r(t);var a=n(11013),o=e([a]);const l=(a=(o.then?(await o)():o)[0]).Z;t.default=l,r()}catch(e){r(e)}}))},11013:function(e,t,n){n.a(e,(async function(e,r){try{n.d(t,{Z:function(){return a.Z}});var a=n(27673),o=e([a]);a=(o.then?(await o)():o)[0],r()}catch(e){r(e)}}))}}]);